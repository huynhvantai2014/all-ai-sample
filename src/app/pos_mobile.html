<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>POSç”»é¢</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <style>
      body {
        max-width: 400px;
        margin: 0 auto;
        font-family: 'Noto Sans JP', sans-serif;
      }
    </style>
  </head>
  <body class="bg-gray-100 flex flex-col items-center justify-center" style="height: 100vh;">
  <main class="w-full max-w-xs px-3 py-3 flex flex-col gap-3 bg-gradient-to-br from-blue-50 via-white to-blue-100 rounded-2xl shadow-2xl" style="height: 95vh; min-height: 500px;">
      <!-- æ¤œç´¢ãƒ»è¿½åŠ æ©Ÿèƒ½ -->
      <section class="flex flex-col gap-2">
        <div class="flex flex-col gap-1 mb-1 relative">
          <div class="flex gap-2 items-center relative">
            <input id="search" type="text" placeholder="ğŸ” æ¤œç´¢" class="border border-blue-200 rounded-lg px-3 py-2 text-xs w-full focus:outline-none focus:ring-2 focus:ring-blue-300 bg-white shadow-sm" autocomplete="off" />
            <button id="scan-barcode" class="bg-gray-200 hover:bg-blue-200 text-blue-700 rounded-lg px-2 py-2 text-xs font-bold shadow transition flex-shrink-0" title="ãƒãƒ¼ã‚³ãƒ¼ãƒ‰ã‚’ã‚¹ã‚­ãƒ£ãƒ³"><span class="text-lg">ğŸ“·</span></button>
            <ul id="suggest-list" class="absolute z-10 bg-white border rounded-lg shadow text-xs w-full hidden left-0 top-full"></ul>
          </div>
        </div>
        <div class="flex gap-2 items-center">
          <button id="add-btn" class="bg-blue-500 hover:bg-blue-600 text-white rounded-lg px-3 py-2 text-xs font-semibold shadow transition w-full">ï¼‹è¿½åŠ </button>
        </div>
      </section>
      <!-- ã‚«ãƒ¼ãƒˆè¡¨ç¤º -->
      <section class="flex flex-col gap-1 flex-1 overflow-auto">
        <div class="flex justify-between items-center mb-1">
          <span class="font-semibold text-blue-700">ğŸ›’ é¸æŠä¸­</span>
          <span class="font-semibold text-blue-700">é‡‘é¡</span>
        </div>
        <ul id="cart-list" class="divide-y border rounded-lg bg-white mb-1 shadow-sm" style="max-height: 260px; overflow-y: auto;"></ul>
      </section>
      <!-- åˆè¨ˆãƒ»ãƒã‚¤ãƒ³ãƒˆ hiá»ƒn thá»‹ dÆ°á»›i cÃ¹ng -->
      <div class="flex flex-col gap-1 w-full max-w-xs mx-auto mb-2">
        <div class="flex justify-between items-center text-lg font-bold bg-blue-100 rounded-lg px-2 py-1">
          <span class="text-blue-700">åˆè¨ˆ</span>
          <span id="total" class="text-blue-700">Â¥0</span>
        </div>
        <div class="flex justify-between items-center text-xs bg-green-50 rounded-lg px-2 py-1">
          <span class="text-green-700">ãƒã‚¤ãƒ³ãƒˆ</span>
          <span id="points" class="text-green-700">0pt</span>
        </div>
      </div>
      </section>
      <!-- æ”¯æ‰•ã„æ–¹æ³• -->
      <!-- ÄÃ£ xÃ³a nÃºt æ”¯æ‰•ã„æ–¹æ³•ã‚’é¸æŠ Ä‘á»ƒ trÃ¡nh trÃ¹ng láº·p -->
      <!-- æ”¯æ‰•ã„æ–¹æ³•ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ— -->
      <div id="payment-modal" class="fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-2xl shadow-2xl p-6 w-72 flex flex-col gap-4">
          <div class="text-lg font-bold text-blue-700 text-center mb-2">æ”¯æ‰•ã„æ–¹æ³•ã‚’é¸æŠ</div>
          <button class="bg-yellow-400 hover:bg-yellow-500 text-white rounded-lg py-2 px-4 font-bold shadow transition" id="pay-cash">ğŸ’µ ç¾é‡‘</button>
          <button class="bg-blue-400 hover:bg-blue-500 text-white rounded-lg py-2 px-4 font-bold shadow transition" id="pay-card">ğŸ’³ ã‚«ãƒ¼ãƒ‰</button>
          <button class="bg-green-400 hover:bg-green-500 text-white rounded-lg py-2 px-4 font-bold shadow transition" id="pay-point">ğŸ ãƒã‚¤ãƒ³ãƒˆ</button>
          <button id="close-payment" class="mt-2 text-gray-500 hover:text-gray-700 text-xs">é–‰ã˜ã‚‹</button>
        </div>
      </div>
      <!-- ä¼šè¨ˆãƒ»ã‚­ãƒ£ãƒ³ã‚»ãƒ« -->
      <section class="flex flex-row gap-2 mt-2">
  <button class="bg-blue-500 hover:bg-blue-600 text-white rounded-xl py-2 px-3 font-semibold text-sm shadow flex-1 transition tracking-wide active:scale-95 focus:outline-none focus:ring-2 focus:ring-blue-300 min-w-[110px] whitespace-nowrap" id="open-payment">ğŸ’³ æ”¯æ‰•ã„</button>
  <button class="bg-gradient-to-r from-green-400 to-green-600 text-white rounded-xl py-2 px-3 font-semibold text-sm shadow flex-1 hover:scale-105 transition tracking-wide active:scale-95 focus:outline-none focus:ring-2 focus:ring-green-300 min-w-[110px] whitespace-nowrap">âœ… ä¼šè¨ˆ</button>
  <button class="bg-gradient-to-r from-red-400 to-red-600 text-white rounded-xl py-2 px-3 font-semibold text-sm shadow flex-1 hover:scale-105 transition tracking-wide active:scale-95 focus:outline-none focus:ring-2 focus:ring-red-300 min-w-[110px] whitespace-nowrap">âŒ ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
      </section>
    </main>
  <footer class="bg-gray-200 text-center py-1 text-xs w-full max-w-xs mx-auto rounded-b-lg opacity-70">Â© 2025 POSã‚·ã‚¹ãƒ†ãƒ </footer>
    <script>
      // ã‚µãƒ³ãƒ—ãƒ«å•†å“ãƒ‡ãƒ¼ã‚¿
      // é›»æ°—åº—ã‚µãƒ³ãƒ—ãƒ«å•†å“ãƒ‡ãƒ¼ã‚¿
      const sampleItems = [
        {
          name: 'å†·è”µåº«',
          code: 'A001',
          price: 45000,
          barcode: '4901234567890',
          desc: 'å¤§å®¹é‡ãƒ»çœã‚¨ãƒå†·è”µåº«'
        },
        {
          name: 'æ´—æ¿¯æ©Ÿ',
          code: 'A002',
          price: 38000,
          barcode: '4901234567891',
          desc: 'é™éŸ³ãƒ»ç¯€æ°´æ´—æ¿¯æ©Ÿ'
        },
        {
          name: 'é›»å­ãƒ¬ãƒ³ã‚¸',
          code: 'A003',
          price: 12000,
          barcode: '4901234567892',
          desc: 'å¤šæ©Ÿèƒ½é›»å­ãƒ¬ãƒ³ã‚¸'
        },
        {
          name: 'ãƒ†ãƒ¬ãƒ“',
          code: 'A004',
          price: 60000,
          barcode: '4901234567893',
          desc: '4Kå¤§å‹æ¶²æ™¶ãƒ†ãƒ¬ãƒ“'
        },
        {
          name: 'ã‚¨ã‚¢ã‚³ãƒ³',
          code: 'A005',
          price: 55000,
          barcode: '4901234567894',
          desc: 'çœã‚¨ãƒãƒ»é™éŸ³ã‚¨ã‚¢ã‚³ãƒ³'
        },
        {
          name: 'æƒé™¤æ©Ÿ',
          code: 'A006',
          price: 15000,
          barcode: '4901234567895',
          desc: 'ã‚³ãƒ¼ãƒ‰ãƒ¬ã‚¹æƒé™¤æ©Ÿ'
        },
        {
          name: 'ç‚Šé£¯å™¨',
          code: 'A007',
          price: 9000,
          barcode: '4901234567896',
          desc: 'é«˜ç«åŠ›ç‚Šé£¯å™¨'
        },        
        {
          name: 'ç‚Šé£¯å™¨',
          code: 'A0071',
          price: 9000,
          barcode: '4901234567896',
          desc: 'é«˜ç«åŠ›ç‚Šé£¯å™¨'
        },
        {
          name: 'ãƒ‘ã‚½ã‚³ãƒ³',
          code: 'A008',
          price: 120000,
          barcode: '4901234567897',
          desc: 'æœ€æ–°ãƒãƒ¼ãƒˆãƒ‘ã‚½ã‚³ãƒ³'
        },
        {
          name: 'ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³',
          code: 'A009',
          price: 80000,
          barcode: '4901234567898',
          desc: 'é«˜æ€§èƒ½ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³'
        },
        {
          name: 'æ‰‡é¢¨æ©Ÿ',
          code: 'A010',
          price: 5000,
          barcode: '4901234567899',
          desc: 'é™éŸ³ãƒ»çœã‚¨ãƒæ‰‡é¢¨æ©Ÿ'
        }
      ];

      const cartList = document.getElementById('cart-list');
      const totalEl = document.getElementById('total');
      const addBtn = document.getElementById('add-btn');
    const searchInput = document.getElementById('search');
      const pointsEl = document.getElementById('points');

      let cart = [];
  let total = 0;
  let points = 0;

      // ÄÃ£ xÃ³a select ã‚µãƒ³ãƒ—ãƒ«

      // å•†å“è¿½åŠ 
      let selectedItem = null;
      addBtn.onclick = function() {
        if (selectedItem) {
          // Check if item already in cart
          const idx = cart.findIndex(i => i.name === selectedItem.name);
          if (idx !== -1) {
            cart[idx].qty += 1;
          } else {
            cart.push({ name: selectedItem.name, price: selectedItem.price, qty: 1 });
          }
          renderCart();
          searchInput.value = '';
          selectedItem = null;
        } else {
          alert('å•†å“ã‚’é¸æŠã—ã¦ãã ã•ã„');
        }
      };

      // æ¤œç´¢æ©Ÿèƒ½
      const suggestList = document.getElementById('suggest-list');
      searchInput.oninput = function() {
        const keyword = searchInput.value.trim();
        if (!keyword) {
          suggestList.innerHTML = '';
          suggestList.classList.add('hidden');
          selectedItem = null;
          return;
        }
        const filtered = sampleItems.filter(item => item.name.includes(keyword));
        if (filtered.length === 0) {
          suggestList.innerHTML = '<li class="px-3 py-2 text-gray-400">è©²å½“å•†å“ãªã—</li>';
        } else {
          suggestList.innerHTML = filtered.map(item => `
            <li class="px-3 py-2 cursor-pointer hover:bg-blue-100" data-name="${item.name}" data-price="${item.price}" data-code="${item.code}" data-barcode="${item.barcode}" data-desc="${item.desc}" style="pointer-events:auto;">
              <div class="font-bold">${item.name} <span class='text-blue-500'>(Â¥${item.price})</span></div>
              <div class="text-xs text-gray-500">å•†å“ã‚³ãƒ¼ãƒ‰: ${item.code} | ãƒãƒ¼ã‚³ãƒ¼ãƒ‰: ${item.barcode}</div>
              <div class="text-xs text-gray-600">${item.desc}</div>
            </li>
          `).join('');
        }
        suggestList.classList.remove('hidden');
        // Re-bind click event after setting innerHTML
        setTimeout(() => {
          Array.from(suggestList.children).forEach(li => {
            li.onclick = function(e) {
              e.stopPropagation();
              const name = li.getAttribute('data-name');
              const price = Number(li.getAttribute('data-price'));
              // Add to cart directly
              const idx = cart.findIndex(i => i.name === name);
              if (idx !== -1) {
                cart[idx].qty += 1;
              } else {
                cart.push({ name, price, qty: 1 });
              }
              renderCart();
              searchInput.value = '';
              selectedItem = null;
              suggestList.classList.add('hidden');
            };
          });
        }, 0);
      };
      // áº¨n gá»£i Ã½ khi click ngoÃ i
      // áº¨n gá»£i Ã½ khi click ngoÃ i
      setTimeout(() => {
        document.addEventListener('click', function(e) {
          if (!searchInput.contains(e.target) && !suggestList.contains(e.target)) {
            suggestList.classList.add('hidden');
          }
        });
      }, 0);

      // ã‚«ãƒ¼ãƒˆè¡¨ç¤º
      function renderCart() {
        cartList.innerHTML = '';
        total = 0;
        // Header row
  const header = document.createElement('li');
  header.className = 'flex justify-between items-center py-0.5 text-xs font-bold bg-blue-50';
  header.innerHTML = `
    <span class="flex items-center gap-1 w-24">å•†å“å</span>
    <span class="flex items-center justify-center w-16">æ•°é‡</span>
    <span class="flex items-center justify-center w-20">é‡‘é¡</span>
    <span class="w-8"></span>
  `;
        cartList.appendChild(header);
        cart.forEach(({ name, price, qty }, idx) => {
          const li = document.createElement('li');
          li.className = 'flex justify-between items-center py-0.5 text-xs';
          li.innerHTML = `
            <span class="flex items-center gap-1 w-24"><span class="text-blue-500">ğŸ“¦</span>${name}</span>
            <span class="flex items-center gap-1 justify-center w-16">
              <button data-action="dec" data-idx="${idx}" class="bg-gray-200 text-gray-600 rounded px-1 py-0.5 text-xs hover:bg-gray-300">âˆ’</button>
              <span class="px-1 text-center w-6">${qty}</span>
              <button data-action="inc" data-idx="${idx}" class="bg-gray-200 text-gray-600 rounded px-1 py-0.5 text-xs hover:bg-gray-300">ï¼‹</button>
            </span>
            <span class="flex items-center justify-center w-20">Â¥${(price * qty).toLocaleString()}</span>
            <span class="flex items-center justify-center w-8"><button data-action="remove" data-idx="${idx}" class="text-red-500 text-xs rounded hover:bg-red-100 px-1" title="å‰Šé™¤"><span class="text-base">ğŸ—‘ï¸</span></button></span>
          `;
          cartList.appendChild(li);
          total += price * qty;
        });
        totalEl.textContent = `Â¥${total.toLocaleString()}`;
        // ãƒã‚¤ãƒ³ãƒˆè¨ˆç®—: 1%é‚„å…ƒ
        points = Math.floor(total * 0.01);
        pointsEl.textContent = `${points}pt`;
        // Sá»± kiá»‡n tÄƒng/giáº£m/xÃ³a sá»‘ lÆ°á»£ng
        Array.from(cartList.querySelectorAll('button[data-action]')).forEach(btn => {
          btn.onclick = function() {
            const idx = Number(btn.getAttribute('data-idx'));
            const action = btn.getAttribute('data-action');
            if (action === 'inc') {
              cart[idx].qty += 1;
            } else if (action === 'dec') {
              if (cart[idx].qty > 1) {
                cart[idx].qty -= 1;
              }
            } else if (action === 'remove') {
              cart.splice(idx, 1);
            }
            renderCart();
          };
        });
      }

      // æ”¯æ‰•ã„æ–¹æ³•ãƒœã‚¿ãƒ³
      // æ”¯æ‰•ã„æ–¹æ³•ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—
      const paymentModal = document.getElementById('payment-modal');
      document.getElementById('open-payment').onclick = function() {
        paymentModal.classList.remove('hidden');
      };
      document.getElementById('close-payment').onclick = function() {
        paymentModal.classList.add('hidden');
      };
      document.getElementById('pay-cash').onclick = function() {
        alert('ç¾é‡‘æ”¯æ‰•ã„ã‚’é¸æŠã—ã¾ã—ãŸ');
        paymentModal.classList.add('hidden');
      };
      document.getElementById('pay-card').onclick = function() {
        alert('ã‚«ãƒ¼ãƒ‰æ”¯æ‰•ã„ã‚’é¸æŠã—ã¾ã—ãŸ');
        paymentModal.classList.add('hidden');
      };
      document.getElementById('pay-point').onclick = function() {
        alert('ãƒã‚¤ãƒ³ãƒˆæ”¯æ‰•ã„ã‚’é¸æŠã—ã¾ã—ãŸ');
        paymentModal.classList.add('hidden');
      };

      // åˆæœŸè¡¨ç¤º
      // QuÃ©t mÃ£ váº¡ch (demo)
      document.getElementById('scan-barcode').onclick = function() {
        if (sampleItems.length > 0) {
          const item = sampleItems[0];
          const idx = cart.findIndex(i => i.name === item.name);
          if (idx !== -1) {
            cart[idx].qty += 1;
          } else {
            cart.push({ name: item.name, price: item.price, qty: 1 });
          }
          renderCart();
        }
        alert('ãƒãƒ¼ã‚³ãƒ¼ãƒ‰ã‚¹ã‚­ãƒ£ãƒ³æ©Ÿèƒ½ï¼ˆãƒ‡ãƒ¢ï¼‰: ' + sampleItems[0].name);
      };
      renderCart();
    </script>
  </body>
</html>
