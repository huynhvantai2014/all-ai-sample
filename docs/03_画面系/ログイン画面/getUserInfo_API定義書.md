# API定義書（IPA標準）

API名: getUserInfo
API ID: API_AUTH_USERINFO_001
エンドポイント: /api/auth/userinfo
HTTPメソッド: GET
関連画面: ログイン画面

## 1. 機能概要
認証済みユーザーの詳細情報を取得する。

## 2. 入力パラメータ

| パラメータ名 | 必須 | データ型 | 桁数 | 説明 | 備考 |
|--------------|------|----------|------|------|------|
| Authorization | ○ | string | 500 | 認証トークン | Bearerトークン形式 |

## 3. 出力パラメータ

| フィールド名 | データ型 | 桁数 | 説明 | 備考 |
|--------------|----------|------|------|------|
| success | boolean | - | 処理成功フラグ | true/false |
| user_id | string | 20 | ユーザーID | - |
| username | string | 50 | ユーザー名 | - |
| role | string | 20 | 権限 | admin/manager/general |
| department | string | 50 | 所属部署 | - |
| last_login | string | - | 最終ログイン日時 | ISO8601形式 |

## 4. エラーコード・メッセージ

| エラーコード | メッセージ | 発生条件 |
|--------------|------------|----------|
| E101 | トークン無効 | 認証トークンが不正 |
| E102 | トークン期限切れ | 認証トークンが期限切れ |
| E103 | ユーザー情報取得失敗 | DB接続エラー等 |
| E999 | システムエラー | 予期しないエラー |

## 5. 処理フロー
1. 認証トークン検証
2. ユーザー情報取得（DB参照）
3. レスポンス返却

## 6. セキュリティ・その他
- JWTトークンの署名検証
- トークン有効期限チェック
- ユーザー存在チェック

## 7. テストケース
- 正常ケース: 有効なトークン
- 異常ケース: 無効なトークン、期限切れトークン

## 8. 備考
- AIによるユーザー行動分析機能付き（最大30%創造性）