# API定義書（IPA標準）

API名: login
API ID: API_AUTH_LOGIN_001
エンドポイント: /api/auth/login
HTTPメソッド: POST
関連画面: ログイン画面

## 1. 機能概要
ユーザー認証を行い、認証成功時にはJWTトークンとユーザー情報を返却する。

## 2. 入力パラメータ

| パラメータ名 | 必須 | データ型 | 桁数 | 説明 | 備考 |
|--------------|------|----------|------|------|------|
| user_id | ○ | string | 20 | ユーザーID | 英数字のみ |
| password | ○ | string | 50 | パスワード | 暗号化して送信 |
| userType | △ | string | 10 | ユーザー種別 | テスト環境のみ |

## 3. 出力パラメータ

| フィールド名 | データ型 | 桁数 | 説明 | 備考 |
|--------------|----------|------|------|------|
| success | boolean | - | 処理成功フラグ | true/false |
| token | string | 500 | 認証トークン | JWT形式 |
| user_id | string | 20 | ユーザーID | 認証されたユーザーID |
| role | string | 20 | 権限 | admin/manager/general |
| expires_in | number | - | トークン有効期限 | 秒数 |

## 4. エラーコード・メッセージ

| エラーコード | メッセージ | 発生条件 |
|--------------|------------|----------|
| E001 | 認証失敗 | ユーザーID・パスワード不一致 |
| E002 | アカウントロック | 連続ログイン失敗によるロック |
| E003 | 入力不備 | 必須パラメータ未入力 |
| E999 | システムエラー | DB接続エラー等 |

## 5. 処理フロー
1. 入力パラメータ検証
2. ユーザー認証（DB照合）
3. JWTトークン生成
4. ログイン履歴記録
5. レスポンス返却

## 6. セキュリティ・その他
- パスワードはハッシュ化して保存
- 連続ログイン失敗時のアカウントロック機能
- ログイン履歴をDBに記録
- JWTトークンは1時間で有効期限切れ

## 7. テストケース
- 正常ケース: 正しいユーザーID・パスワード
- 異常ケース: 不正なユーザーID・パスワード
- 境界値: パスワード桁数上限・下限

## 8. 備考
- テスト環境ではuserTypeパラメータで任意のユーザー種別を指定可能
- AIによるパスワード強度判定機能付き（最大30%創造性）