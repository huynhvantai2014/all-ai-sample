# 画面定義書（IPA標準）

画面名 (Tên màn hình): レジ販売画面
画面ID (Mã màn hình): SRC0004
画面物理名 (Tên vật lý màn hình): checkout_screen

## 権限定義 (Phân quyền)

| 画面物理名      | Quản trị | Nhân viên | Khách | Dev/Test |
|-----------------|---------|-----------|-------|----------|
| checkout_screen | ○       | ○         |       | ○        |

## 項目定義 (Định nghĩa item)

| 論理名           | 物理名      | 項目タイプ   | 説明                                 | IN/OUT | 必須 | 桁数 | 正規表現 | 初期値 | 制御内容 | 備考 |
|------------------|-------------|-------------|--------------------------------------|--------|------|------|--------|--------|--------|------|
| バーコード/JAN/SKU | scan        | text        | Nhập barcode/JAN/SKU sản phẩm        | IN     | ○    |      |        |        |        |      |
| 数量             | quantity    | number      | Số lượng sản phẩm                    | IN     | ○    |      |        | 1      |        |      |
| 割引/バウチャー   | discount    | text        | Nhập mã giảm giá, voucher            | IN     |      |      |        |        |        |      |
| 価格             | price       | text        | Giá sản phẩm                         | IN     | ○    |      |        |        |        |      |
| 消費税           | tax         | text        | Thuế tiêu dùng (10%)                 | OUT    |      |      |        | 0      | readonly|      |
| 合計金額         | total       | text        | Tổng tiền                            | OUT    | ○    |      |        | 0      | readonly|      |
| 決済方法         | payment     | select      | Chọn phương thức thanh toán          | IN     | ○    |      |        |        |        |      |
| 領収書/レシート   | receipt     | button      | In/xuất hóa đơn, biên nhận           | IN     |      |      |        |        |        |      |
| 商品リスト       | product_list| table       | Bảng sản phẩm, số lượng, giá, giảm giá| OUT    | ○    |      |        |        |        |      |
| 編集/削除        | edit_btn/del_btn| button   | Chỉnh sửa/xóa sản phẩm               | IN     |      |      |        |        |        |      |

## イベント定義 (Event Definition)

### scan onBlur

- Kiểm tra barcode/JAN/SKU, thêm sản phẩm vào bảng

### quantity onChange

- Cập nhật số lượng, tính lại tổng tiền

### discount onBlur

- Áp dụng mã giảm giá, voucher

### payment onChange

- Chọn phương thức thanh toán, xử lý nghiệp vụ

### receipt onClick

- In/xuất hóa đơn, biên nhận

### edit_btn/del_btn onClick

- Chỉnh sửa/xóa sản phẩm khỏi bảng

## 画面遷移 (Screen Transition)

| 遷移元画面ID | 遷移元画面名   | 遷移先画面ID | 遷移先画面名     | 条件・イベント           | 備考 |
|--------------|----------------|--------------|------------------|-------------------------|------|
| SRC0004      | レジ販売画面   | SRC0003      | 仮販売一覧画面   | Quay lại danh sách      |      |
| SRC0004      | レジ販売画面   | SRC0004      | レジ販売画面     | Thêm/xóa/sửa sản phẩm   |      |

## アクション一覧 (Action List)

| アクション名 | 論理名      | 説明                | 条件・権限 | API名                      | HTTPメソッド | 関連イベント         | 備考 |
|--------------|-------------|---------------------|------------|---------------------------|-------------|---------------------|------|
| Thêm sản phẩm| add_product | Thêm sản phẩm vào bảng| Nhân viên  | /api/checkout/add-product | POST        | scan onBlur         |      |
| Sửa sản phẩm | edit_product| Sửa thông tin sản phẩm| Nhân viên  | /api/checkout/edit-product| PUT         | edit_btn onClick    |      |
| Xóa sản phẩm | delete_product| Xóa sản phẩm khỏi bảng| Nhân viên | /api/checkout/delete-product| DELETE     | del_btn onClick     |      |
| Thanh toán   | payment     | Xử lý thanh toán      | Nhân viên  | /api/checkout/payment     | POST        | payment onChange    |      |
| In hóa đơn   | receipt     | In/xuất hóa đơn       | Nhân viên  | /api/checkout/receipt     | GET         | receipt onClick     |      |

## Mock/Đối chiếu

- Mock HTML/CSS đã có đầy đủ form nhập barcode, số lượng, giá, giảm giá, bảng sản phẩm, chọn phương thức thanh toán, in hóa đơn, layout hiện đại, màu sắc, font đồng nhất.
- Không phát hiện thiếu thành phần nghiệp vụ chính.

## Message/Error

- Hiển thị thông báo lỗi khi nhập barcode sai, thanh toán thất bại, in hóa đơn lỗi
- Sử dụng message từ docs/templates/メッセージ一覧_Template.md

## Ghi chú

- Nếu bổ sung chức năng mới (ví dụ: chia nhỏ thanh toán), cần cập nhật lại định nghĩa màn hình và API
- Nếu có điểm chưa rõ, ghi chú "Cần xác nhận" hoặc "レイアウト情報不足"
